services:
  - type: web
    name: placement-expo
    env: node
    plan: free
    buildCommand: |
      # Install Java and Maven using Node.js environment
      curl -s "https://get.sdkman.io" | bash
      source "$HOME/.sdkman/bin/sdkman-init.sh"
      sdk install java 17.0.2-open
      sdk install maven
      mvn clean package -DskipTests
    startCommand: java -Dserver.port=$PORT -jar target/placement_expo-0.0.1-SNAPSHOT.jar
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: production
      - key: UPLOAD_DIR
        value: /tmp/uploads
      - key: CORS_ALLOWED_ORIGINS
        value: "*"
      - key: JAVA_TOOL_OPTIONS
        value: "-Xmx512m"

databases:
  - name: placement-db
    databaseName: placement_expo
    user: placement_user
    plan: free
